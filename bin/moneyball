#!/usr/bin/env ruby

require 'rubygems'
require 'commander/import'
require 'moneyball'

program :version, '0.0.1'
program :description, 'CLI application that will be used to provide information about baseball player statistics'

command :bootstrap do |c|
  c.syntax = 'moneyball bootstrap'
  c.summary = 'Bootstraps the database from CSV files.'
  c.action do |args, options|
    db = Moneyball::Database.new
    db.bootstrap
  end
end

command :most_improved_batting_avg do |c|
  c.syntax = 'moneyball most_improved_batting_avg'
  c.summary = "Returns the player with the most improved batting average given a range of years."
  c.option '--from STRING', String, 'The starting year (ex: 2007)'
  c.option '--to STRING', String, 'The ending year (ex: 2007)'
  c.action do |args, options|
    winner = Moneyball::BattingStat.most_improved_batting_avg(options.from, options.to)
    puts "Most improved batting average from #{options.from} to #{options.to}: #{winner}"
  end
end

command :team_slugging_percentage do |c|
  c.syntax = 'moneyball team_slugging_percentage'
  c.summary = 'Returns the season slugging percentage for a team given a team ID and year.'
  c.option '--team STRING', String, 'The team ID (ex: OAK)'
  c.option '--year STRING', String, 'The year (ex: 2007)'
  c.action do |args, options|
    team_slugging_percentage = Moneyball::BattingStat.team_slugging_percentage(options.team, options.year)
    puts "Slugging Percentage for #{options.team} in #{options.year}: #{team_slugging_percentage}"
  end
end

command :triple_crown_winner do |c|
  c.syntax = 'moneyball team_slugging_percentage'
  c.summary = "Determines and returns the League's Triple Crown winner for a given year."
  c.option '--league STRING', String, 'The league ID (ex: AL)'
  c.option '--year STRING', String, 'The year (ex: 2007)'
  c.action do |args, options|
    winner = Moneyball::BattingStat.triple_crown_winner(options.league, options.year)
    puts "The #{options.leage} Triple Crown Winner for #{options.year}: #{winner}"
  end
end
